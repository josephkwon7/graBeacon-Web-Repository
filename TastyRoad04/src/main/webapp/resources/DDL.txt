/*각 테이블의 유니크한 ID생성을 위해 sequence 생성 */
CREATE SEQUENCE beacon_seq START WITH 1000 INCREMENT BY 1 NOCACHE NOCYCLE;

CREATE SEQUENCE restaurant_seq START WITH 1000 INCREMENT BY 1 NOCACHE NOCYCLE;

CREATE SEQUENCE owner_seq START WITH 1000 INCREMENT BY 1 NOCACHE NOCYCLE;

/* 비콘 */
CREATE TABLE DWF2.BEACON (
	beacon_id NUMBER(4) NOT NULL, /* 비콘ID */
	uuid VARCHAR2(36), /* UUID */
	major NUMBER(5), /* Major */
	minor NUMBER(5), /* Minor */
	res_id NUMBER(4) /* 맛집ID */
);

COMMENT ON TABLE DWF2.BEACON IS '비콘';

COMMENT ON COLUMN DWF2.BEACON.beacon_id IS '비콘ID';

COMMENT ON COLUMN DWF2.BEACON.uuid IS 'UUID';

COMMENT ON COLUMN DWF2.BEACON.major IS 'Major';

COMMENT ON COLUMN DWF2.BEACON.minor IS 'Minor';

COMMENT ON COLUMN DWF2.BEACON.res_id IS '맛집ID';

CREATE UNIQUE INDEX DWF2.PK_BEACON
	ON DWF2.BEACON (
		beacon_id, major, minor ASC
	);




/* 맛집 */
CREATE TABLE DWF2.RESTAURANT (
	res_id NUMBER(4) NOT NULL, /* 맛집ID */
	name VARCHAR2(255), /* 상호 */
	addr VARCHAR2(255), /* 주소 */
	phone VARCHAR2(13), /* 전화번호 */
	license_no VARCHAR2(12), /* 사업자번호 */
	geo_lat NUMBER(8,6), /* 위치위도 */
	geo_long NUMBER(9,6), /* 위치경도 */
	img_small1 VARCHAR2(255), /* 이미지(소)1 */
	img_small2 VARCHAR2(255), /* 이미지(소)2 */
	img_small3 VARCHAR2(255), /* 이미지(소)3 */
	img_big1 VARCHAR2(255), /* 이미지(대)1 */
	img_big2 VARCHAR2(255), /* 이미지(대)2 */
	img_big3 VARCHAR2(255), /* 이미지(대)3 */
	img_big4 VARCHAR2(255), /* 이미지(대)4 */
	img_menu VARCHAR2(255), /* 비고(메뉴판) */
	copy_comment VARCHAR2(255) /* 광고문구(간략) */
);

COMMENT ON TABLE DWF2.RESTAURANT IS '맛집';

COMMENT ON COLUMN DWF2.RESTAURANT.res_id IS '맛집ID';

COMMENT ON COLUMN DWF2.RESTAURANT.name IS '상호';

COMMENT ON COLUMN DWF2.RESTAURANT.addr IS '주소';

COMMENT ON COLUMN DWF2.RESTAURANT.phone IS '전화번호';

COMMENT ON COLUMN DWF2.RESTAURANT.license_no IS '사업자번호';

COMMENT ON COLUMN DWF2.RESTAURANT.geo_lat IS '위치위도';

COMMENT ON COLUMN DWF2.RESTAURANT.geo_long IS '위치경도';

COMMENT ON COLUMN DWF2.RESTAURANT.img_small1 IS '이미지(소)1';

COMMENT ON COLUMN DWF2.RESTAURANT.img_small2 IS '이미지(소)2';

COMMENT ON COLUMN DWF2.RESTAURANT.img_small3 IS '이미지(소)3';

COMMENT ON COLUMN DWF2.RESTAURANT.img_big1 IS '이미지(대)1';

COMMENT ON COLUMN DWF2.RESTAURANT.img_big2 IS '이미지(대)2';

COMMENT ON COLUMN DWF2.RESTAURANT.img_big3 IS '이미지(대)3';

COMMENT ON COLUMN DWF2.RESTAURANT.img_big4 IS '이미지(대)4';

COMMENT ON COLUMN DWF2.RESTAURANT.img_menu IS '비고(메뉴판)';

COMMENT ON COLUMN DWF2.RESTAURANT.copy_comment IS '광고문구(간략)';

CREATE UNIQUE INDEX DWF2.PK_RESTAURANT
	ON DWF2.RESTAURANT (
		res_id ASC
	);



/* 관리자 */
CREATE TABLE DWF2.ADMINISTRATOR (
	admin_id VARCHAR2(255) NOT NULL, /* 관리자ID */
	password VARCHAR2(255) NOT NULL /* 패스워드 */
);

COMMENT ON TABLE DWF2.ADMINISTRATOR IS '관리자';

COMMENT ON COLUMN DWF2.ADMINISTRATOR.admin_id IS '관리자ID';

COMMENT ON COLUMN DWF2.ADMINISTRATOR.password IS '패스워드';

CREATE UNIQUE INDEX DWF2.PK_ADMINISTRATOR
	ON DWF2.ADMINISTRATOR (
		admin_id ASC
	);



/* 점주 */
CREATE TABLE DWF2.OWNER (
	owner_id NUMBER(4) NOT NULL, /* 점주ID */
	name VARCHAR2(255), /* 이름 */
	phone VARCHAR2(255), /* 전화번호 */
	addr VARCHAR2(255), /* 주소 */
	email VARCHAR2(255), /* 메일 */
	res_id NUMBER(4) /* 맛집ID */
);

COMMENT ON TABLE DWF2.OWNER IS '점주';

COMMENT ON COLUMN DWF2.OWNER.owner_id IS '점주ID';

COMMENT ON COLUMN DWF2.OWNER.name IS '이름';

COMMENT ON COLUMN DWF2.OWNER.phone IS '전화번호';

COMMENT ON COLUMN DWF2.OWNER.addr IS '주소';

COMMENT ON COLUMN DWF2.OWNER.email IS '메일';

COMMENT ON COLUMN DWF2.OWNER.res_id IS '맛집ID';

CREATE UNIQUE INDEX DWF2.PK_OWNER
	ON DWF2.OWNER (
		owner_id ASC
	);


/* ADD CONSTRAINT */

ALTER TABLE DWF2.BEACON
	ADD
		CONSTRAINT PK_BEACON2
		PRIMARY KEY (
			beacon_id
		);

ALTER TABLE DWF2.RESTAURANT
	ADD
		CONSTRAINT PK_RESTAURANT
		PRIMARY KEY (
			res_id
		);

ALTER TABLE DWF2.ADMINISTRATOR
	ADD
		CONSTRAINT PK_ADMINISTRATOR
		PRIMARY KEY (
			admin_id
		);


ALTER TABLE DWF2.OWNER
	ADD
		CONSTRAINT PK_OWNER2
		PRIMARY KEY (
			owner_id
		);

/* 
ALTER TABLE DWF2.BEACON
	ADD
		CONSTRAINT FK_RESTAURANT_TO_BEACON
		FOREIGN KEY (
			res_id
		)
		REFERENCES DWF2.RESTAURANT (
			res_id
		);



ALTER TABLE DWF2.OWNER
	ADD
		CONSTRAINT FK_RESTAURANT_TO_OWNER
		FOREIGN KEY (
			res_id
		)
		REFERENCES DWF2.RESTAURANT (
			res_id
		);
*/