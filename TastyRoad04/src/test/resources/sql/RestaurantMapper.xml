<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="RestaurantMapper">
 
	<resultMap id="restaurantSelectMap" type="restaurant">
		<result property="resId" column="res_id" jdbcType="INTEGER"/>
		<result property="name" column="name" jdbcType="VARCHAR"/>
		<result property="addr" column="addr" jdbcType="VARCHAR" />
		<result property="phone" column="phone" jdbcType="VARCHAR" />
		<result property="licenseNo" column="license_no" jdbcType="VARCHAR" />
		<result property="geoLat" column="geo_lat" jdbcType="DOUBLE"  />
		<result property="geoLong" column="geo_long" jdbcType="DOUBLE"  />
		<result property="imgSmall1" column="img_small1" jdbcType="VARCHAR"  />
		<result property="imgBig1" column="img_big1" jdbcType="VARCHAR"  />
		<result property="imgBig2" column="img_big2" jdbcType="VARCHAR"  />
		<result property="imgBig3" column="img_big3" jdbcType="VARCHAR"  />
		<result property="imgMarker" column="img_marker" jdbcType="VARCHAR"  />
		<result property="imgMenu" column="img_menu" jdbcType="VARCHAR"  />
		<result property="copyComment" column="copy_comment" jdbcType="VARCHAR"  />
		<result property="resType" column="res_type" jdbcType="INTEGER"/>
	</resultMap>

	<insert id="addRestaurant" parameterType="restaurant" >
	 	INSERT 
	 	INTO restaurant(res_id, name, addr, phone, license_no, geo_lat, geo_long, 
	 	img_small1, img_big1, img_big2, img_big3, img_marker, img_menu, copy_comment, res_type)  
		VALUES	 (restaurant_seq.NEXTVAL, #{name,jdbcType=VARCHAR}, #{addr,jdbcType=VARCHAR}, 
		#{phone,jdbcType=VARCHAR}, #{licenseNo,jdbcType=VARCHAR}, #{geoLat,jdbcType=DOUBLE}, #{geoLong,jdbcType=DOUBLE}, 
		#{imgSmall1,jdbcType=VARCHAR}, #{imgBig1,jdbcType=VARCHAR}, #{imgBig2,jdbcType=VARCHAR}, #{imgBig3,jdbcType=VARCHAR}, 
		#{imgMarker,jdbcType=VARCHAR}, #{imgMenu,jdbcType=VARCHAR}, #{copyComment,jdbcType=VARCHAR}, #{resType,jdbcType=INTEGER})
	</insert>
	
	<select id="findRestaurant" parameterType="restaurant" resultMap="restaurantSelectMap">
		SELECT
		res_id, name, addr, phone, license_no, geo_lat, geo_long, img_small1, 
	 		img_big1, img_big2, img_big3, img_marker, img_menu, copy_comment, res_type		
		FROM restaurant 
		WHERE name = #{name}
	</select>
	 
	<select id="getRestaurant" parameterType="INTEGER" resultMap="restaurantSelectMap">
		SELECT
		res_id, name, addr, phone, license_no, geo_lat, geo_long, img_small1, 
	 		img_big1, img_big2, img_big3, img_marker, img_menu, copy_comment, res_type		
		FROM restaurant 
		WHERE res_id = #{value}
		<!-- #{age:INTEGER} #{regDate:DATE} ) -->
	</select>
	
	<update id="updateRestaurant" parameterType="restaurant">
		UPDATE restaurant
		<set>
			<if test="name != null">name = #{name},</if>
			<if test="addr != null">addr = #{addr},</if>
			<if test="phone != null">phone = #{phone},</if>
			<if test="licenseNo != null">license_no = #{licenseNo},</if>
			<if test="geoLat != null">geo_lat = #{geoLat},</if>
			<if test="geoLong != null">geo_long = #{geoLong},</if>
			<if test="imgSmall1 != null">img_small1 = #{imgSmall1},</if>
			<if test="imgBig1 != null">img_big1 = #{imgBig1},</if>
			<if test="imgBig2 != null">img_big2 = #{imgBig2},</if>
			<if test="imgBig3 != null">img_big3 = #{imgBig3},</if>
			<if test="imgMarker != null">img_marker = #{imgMarker},</if>
			<if test="imgMenu != null">img_menu = #{imgMenu},</if>
			<if test="copyComment != null">copy_comment = #{copyComment},</if>
			<if test="resType != null">res_type = #{resType}</if>
	
		</set>	
		WHERE res_id = #{resId}
	</update>
	
	<delete	id="removeRestaurant" 	parameterType="INTEGER" >
		DELETE 
		FROM restaurant 
		WHERE res_id = #{resId}
	</delete>
<!--  	 
	<sql id="select-beacon">
		SELECT
		beacon_id, uuid, major, minor, res_id 		
		FROM beacon 
	</sql>
	
	<sql id="orderby-beaconId-desc">
	 	ORDER BY beacon_id DESC
	</sql>
	
	<select id="getBeaconList" parameterType="search" 
	 											  resultMap="userSelectMap">
	
		<include refid="select-users"/>
	
		<where>
			<choose>
				<when test=" searchCondition=='userId' ">
					<if test="userId.size !=0">
					user_id IN
					<foreach 	item="value" 		collection="userId"  
										open="(" 			separator= ","			close=")">
						#{value}
					</foreach>
				</if>
				</when>
			
				<when test="searchCondition=='userName' ">
					<if test="userName[0] !=null"  >
					user_name IN
					<foreach 	item="value" 		collection="userName"  
										open="(" 			separator= ","			close=")">
						#{value}
					</foreach>
					</if>
				</when>
			</choose>
			
		</where>
		<include refid="orderby-userId-desc"/>
		
	 </select>
-->	 
</mapper>